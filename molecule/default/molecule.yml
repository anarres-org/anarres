---

driver:
  name: vagrant
  provider:
    name: virtualbox
lint:
  name: yamllint
  options:
    config-file: molecule/default/.yamllint
platforms:
  - name: stretch
    box: debian/stretch64
    interfaces:
      - network_name: private_network
        auto_config: true
        ip: 172.16.100.12
        type: static
    instance_raw_config_args:
      - "vm.synced_folder '.', '/vagrant', disabled: true"
    memory: 2048
    groups:
      - anarres
provisioner:
  name: ansible
  playbooks:
    converge: ../../full.yml
  options:
    extra-vars:
      testing: true
      docker_registry_mirror: http://172.16.100.1:5000
      ansible_become: true
      ansible_sudo: true
      user_uid_1000: vagrant
      base_domain: anarres.local
      db_pass: changeme
      ssh_port: 22
      openldap_organization: anarres
      openldap_base_DN: dc=anarres,dc=local
      openldap_admin_password: changeme
      openldap_readonly_password: changeme
      gitea_ssh_port: 66
      gitea_db_user_pass: changeme
      drone_github_client_id: placeholder
      drone_github_client_secret: placeholder
      codimd_db_user_pass: changeme
      transmission_user: transmission
      transmission_pass: transmission
      transmission_timezone: Europe/Berlin
      wallabag_db_user_pass: changeme
      openvpn_ca_pass: changeme
      nextcloud_db_user_pass: changeme
      taiga_secret_key: changeme
      taiga_db_user_pass: changeme
      user_uid_101: systemd-network
      wikijs_admin_email: admin@anarres.local
      wikijs_title: Anarres Wiki
      wikijs_public: true
      wikijs_session_secret: changeme
      wikijs_repo_url: https://github.com/anarres-org/anarres
      wikijs_repo_branch: master
      wikijs_repo_user: test
      wikijs_repo_pass: test
      wikijs_repo_commit_email: "{{ wikijs_admin_email }}"

### DB

wikijs_db_image: "{{ docker_db_mongo_image }}"
wikijs_db_service_name: wikijs-db
wikijs_db_user: "wikijs"
wikijs_db_user_pass:
wikijs_db_name: "wikijs"

### LDAP

wikijs_enable_ldap: false
wikijs_ldap_url: "{{ openldap_server_uri }}"
wikijs_ldap_binddn: "{{ openldap_binddn }}"
wikijs_ldap_bindcredentials: "{{ openldap_bindcredentials }}"
wikijs_ldap_searchbase: "{{ openldap_searchbase }}"
wikijs_ldap_searchfilter: "{{ '(uid={{username}})' }}"
wikijs_ldap_searchattributes: 'uid, mail'
wikijs_ldap_userfield: 'uid'
wikijs_ldap_usernamefield: 'uid'
  lint:
    name: ansible-lint
    options:
      exclude:
        - roles/
scenario:
  name: default
verifier:
  name: testinfra
  lint:
    name: flake8
