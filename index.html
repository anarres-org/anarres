


<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
        <link rel="canonical" href="https://anarres-org.github.io/anarres/">
      
      
      <link rel="shortcut icon" href="assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.1.2, mkdocs-material-5.5.7">
    
    
      
        <title>Anarres documentation</title>
      
    
    
      <link rel="stylesheet" href="assets/stylesheets/main.b8ac9624.min.css">
      
      
    
    
    
      
        <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>body,input{font-family:"Roboto",-apple-system,BlinkMacSystemFont,Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono",SFMono-Regular,Consolas,Menlo,monospace}</style>
      
    
    
    
    
      
    
    
  
        <style>
        .git-revision-date-localized-plugin-iso_date { display: none }
        @media print {
           .git-revision-date-localized-plugin-iso_date { display: inline } 
           .git-revision-date-localized-plugin-timeago { display: none } 
        }
        </style>
        </head>
  
  
    <body dir="ltr">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#anarres-full-playbook" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid" aria-label="Header">
    <a href="https://anarres-org.github.io/anarres" title="Anarres documentation" class="md-header-nav__button md-logo" aria-label="Anarres documentation">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 003-3 3 3 0 00-3-3 3 3 0 00-3 3 3 3 0 003 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    <label class="md-header-nav__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header-nav__title" data-md-component="header-title">
      
        <div class="md-header-nav__ellipsis">
          <span class="md-header-nav__topic md-ellipsis">
            Anarres documentation
          </span>
          <span class="md-header-nav__topic md-ellipsis">
            
              Anarres Full Playbook
            
          </span>
        </div>
      
    </div>
    
      <label class="md-header-nav__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" data-md-state="active">
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <button type="reset" class="md-search__icon md-icon" aria-label="Clear" data-md-component="search-reset" tabindex="-1">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header-nav__source">
        
<a href="https://github.com/anarres-org/anarres/" title="Go to repository" class="md-source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05L244 40.45a28.87 28.87 0 00-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 01-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 000 40.81l195.61 195.6a28.86 28.86 0 0040.8 0l194.69-194.69a28.86 28.86 0 000-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    anarres-org/anarres
  </div>
</a>
      </div>
    
  </nav>
</header>
    
    <div class="md-container" data-md-component="container">
      
        
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="https://anarres-org.github.io/anarres" title="Anarres documentation" class="md-nav__button md-logo" aria-label="Anarres documentation">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 003-3 3 3 0 00-3-3 3 3 0 00-3 3 3 3 0 003 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    Anarres documentation
  </label>
  
    <div class="md-nav__source">
      
<a href="https://github.com/anarres-org/anarres/" title="Go to repository" class="md-source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05L244 40.45a28.87 28.87 0 00-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 01-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 000 40.81l195.61 195.6a28.86 28.86 0 0040.8 0l194.69-194.69a28.86 28.86 0 000-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    anarres-org/anarres
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    
      
    
    
      <label class="md-nav__link md-nav__link--active" for="__toc">
        Anarres Full Playbook
        <span class="md-nav__icon md-icon">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 9h14V7H3v2m0 4h14v-2H3v2m0 4h14v-2H3v2m16 0h2v-2h-2v2m0-10v2h2V7h-2m0 6h2v-2h-2v2z"/></svg>
        </span>
      </label>
    
    <a href="." title="Anarres Full Playbook" class="md-nav__link md-nav__link--active">
      Anarres Full Playbook
    </a>
    
      
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#usage" class="md-nav__link">
    Usage
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#compatibility" class="md-nav__link">
    Compatibility
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#requirements" class="md-nav__link">
    Requirements
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#playbook-variables" class="md-nav__link">
    Playbook Variables
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#dependencies" class="md-nav__link">
    Dependencies
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#services" class="md-nav__link">
    Services
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#setup" class="md-nav__link">
    Setup
  </a>
  
    <nav class="md-nav" aria-label="Setup">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#tips" class="md-nav__link">
    Tips
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#firewall" class="md-nav__link">
    Firewall
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#letsencrypt" class="md-nav__link">
    Letsencrypt
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#nvidia-runtime-support" class="md-nav__link">
    Nvidia runtime support
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#backup" class="md-nav__link">
    Backup
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#license" class="md-nav__link">
    License
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#author-information" class="md-nav__link">
    Author Information
  </a>
  
</li>
      
    </ul>
  
</nav>
    
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="ldap/" title="LDAP configuration" class="md-nav__link">
      LDAP configuration
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="testing/" title="Testing" class="md-nav__link">
      Testing
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-4" type="checkbox" id="nav-4">
    
    <label class="md-nav__link" for="nav-4">
      Services
      <span class="md-nav__icon md-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M8.59 16.58L13.17 12 8.59 7.41 10 6l6 6-6 6-1.41-1.42z"/></svg>
      </span>
    </label>
    <nav class="md-nav" aria-label="Services" data-md-level="1">
      <label class="md-nav__title" for="nav-4">
        <span class="md-nav__icon md-icon">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
        </span>
        Services
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="services/anki_sync_server/" title="Anki sync server" class="md-nav__link">
      Anki sync server
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="services/bazarr/" title="Bazarr" class="md-nav__link">
      Bazarr
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="services/bind_dns_server/" title="BIND DNS server" class="md-nav__link">
      BIND DNS server
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="services/clair/" title="CoreOS Clair" class="md-nav__link">
      CoreOS Clair
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="services/codimd/" title="CodiMD" class="md-nav__link">
      CodiMD
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="services/drone/" title="Drone" class="md-nav__link">
      Drone
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="services/drone_github/" title="Drone for GitHub" class="md-nav__link">
      Drone for GitHub
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="services/gitea/" title="Gitea" class="md-nav__link">
      Gitea
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="services/grafana/" title="Grafana" class="md-nav__link">
      Grafana
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="services/home_assistant/" title="Home Assistant" class="md-nav__link">
      Home Assistant
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="services/influxdb/" title="InfluxDB" class="md-nav__link">
      InfluxDB
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="services/jackett/" title="Jackett" class="md-nav__link">
      Jackett
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="services/jellyfin/" title="Jellyfin" class="md-nav__link">
      Jellyfin
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="services/jupyterhub/" title="JupyterHub" class="md-nav__link">
      JupyterHub
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="services/lidarr/" title="Lidarr" class="md-nav__link">
      Lidarr
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="services/moodle/" title="Moodle" class="md-nav__link">
      Moodle
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="services/murmur/" title="Murmur" class="md-nav__link">
      Murmur
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="services/nextcloud/" title="Nextcloud" class="md-nav__link">
      Nextcloud
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="services/nfs/" title="NFS" class="md-nav__link">
      NFS
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="services/ombi/" title="Ombi" class="md-nav__link">
      Ombi
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="services/openldap/" title="OpenLDAP" class="md-nav__link">
      OpenLDAP
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="services/openvpn/" title="OpenVPN" class="md-nav__link">
      OpenVPN
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="services/phpldapadmin/" title="phpLDAPadmin" class="md-nav__link">
      phpLDAPadmin
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="services/portainer/" title="Portainer" class="md-nav__link">
      Portainer
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="services/prosody/" title="Prosody" class="md-nav__link">
      Prosody
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="services/radarr/" title="Radarr" class="md-nav__link">
      Radarr
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="services/radicale/" title="Radicale" class="md-nav__link">
      Radicale
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="services/registry/" title="Registry" class="md-nav__link">
      Registry
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="services/registry_web_interface/" title="Registry web interface" class="md-nav__link">
      Registry web interface
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="services/rstudio/" title="RStudio" class="md-nav__link">
      RStudio
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="services/sonarr/" title="Sonarr" class="md-nav__link">
      Sonarr
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="services/syncthing/" title="Syncthing" class="md-nav__link">
      Syncthing
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="services/taiga/" title="Taiga" class="md-nav__link">
      Taiga
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="services/taskd/" title="Taskd" class="md-nav__link">
      Taskd
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="services/transmision/" title="Tranmission" class="md-nav__link">
      Tranmission
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="services/transmision_openvpn/" title="Transmission-OpenVPN" class="md-nav__link">
      Transmission-OpenVPN
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="services/wikijs/" title="Wiki.js" class="md-nav__link">
      Wiki.js
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#usage" class="md-nav__link">
    Usage
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#compatibility" class="md-nav__link">
    Compatibility
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#requirements" class="md-nav__link">
    Requirements
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#playbook-variables" class="md-nav__link">
    Playbook Variables
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#dependencies" class="md-nav__link">
    Dependencies
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#services" class="md-nav__link">
    Services
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#setup" class="md-nav__link">
    Setup
  </a>
  
    <nav class="md-nav" aria-label="Setup">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#tips" class="md-nav__link">
    Tips
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#firewall" class="md-nav__link">
    Firewall
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#letsencrypt" class="md-nav__link">
    Letsencrypt
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#nvidia-runtime-support" class="md-nav__link">
    Nvidia runtime support
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#backup" class="md-nav__link">
    Backup
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#license" class="md-nav__link">
    License
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#author-information" class="md-nav__link">
    Author Information
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/anarres-org/anarres/edit/master/docs/index.md" title="Edit this page" class="md-content__button md-icon">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25z"/></svg>
                  </a>
                
                
                  
                
                
                <h1 id="anarres-full-playbook">Anarres Full Playbook</h1>
<p>An <a href="https://github.com/ansible">ansible</a> playbook to set up a GNU/Linux server.
Services in <a href="https://www.docker.com/">docker</a>. Security by default.</p>
<p>The goal is to have a server for a community or personal use that's easy to
maintain, secure and easy (and fast) to rebuild from scratch in case of data
loss or a migration.</p>
<p>The idea came from a great FLOSS project,
<a href="https://github.com/sovereign/sovereign">sovereign</a>, specially from <a href="https://github.com/sovereign/sovereign/issues/667">sovereign
2 issue</a>.</p>
<p>What you'll get with this repo is a recipe based in variables that will setup a
working server for your specific needs. You'll have the data stored only in one
or two directories depending on your choices, see <a href="#backup">backup</a>. The
docker containers will upgrade themselves automatically every time their
service restarts (you can do this periodically or it'll happen anyways when you
reboot).</p>
<p>Apart from this, it's easy to extend and doesn't prevent you from using other
playbooks apart from this one or installing things manually.</p>
<h2 id="usage">Usage</h2>
<p>Clone the repo and its submodules with:</p>
<div class="highlight"><pre><span></span><code>git clone --recurse-submodules -j8 <span class="o">[</span>repo<span class="o">]</span>
</code></pre></div>

<p>Then follow the <a href="#setup">Setup</a> section.</p>
<h2 id="compatibility">Compatibility</h2>
<p>These are the tested GNU/Linux distributions. Maybe it works on some other
distributions too or just requires a few changes.</p>
<ul>
<li><a href="https://www.debian.org/">debian</a></li>
<li>stretch</li>
</ul>
<h2 id="requirements">Requirements</h2>
<p><code>sudo</code> and <code>python</code>.</p>
<h2 id="playbook-variables">Playbook Variables</h2>
<p>TBD.</p>
<h2 id="dependencies">Dependencies</h2>
<p>Included as submodules in <em>roles/</em>.</p>
<ul>
<li><a href="https://github.com/Nordeus/ansible_iptables_raw">iptables_raw</a></li>
<li><a href="https://github.com/anarres-org/anarres-common">anarres-common</a></li>
<li><a href="https://github.com/anarres-org/anarres-sec">anarres-sec</a></li>
<li><a href="https://github.com/anarres-org/letsencrypt-request">letsencrypt-request</a></li>
<li><a href="https://github.com/anarres-org/anarres-nginx">anarres-nginx</a></li>
<li><a href="https://github.com/anarres-org/generic_docker_systemd">generic_docker_systemd</a></li>
<li><a href="https://github.com/anarres-org/add_nginx_proxy_conf">add_nginx_proxy_conf</a></li>
</ul>
<h2 id="services">Services</h2>
<p>Their data and configuration files will be stored in your hosts <code>data_path</code>
directory, by default <em>/data</em>.</p>
<ul>
<li><a href="https://docs.docker.com/registry/">Docker Registry</a>: A stateless, highly
   scalable server side application that stores and lets you distribute Docker
   images. Using <a href="https://hub.docker.com/_/registry">library/registry</a>.</li>
<li><a href="https://github.com/coreos/clair">CoreOS Clair</a>: Vulnerability Static Analysis
   for Containers. Using
   <a href="https://quay.io/repository/coreos/clair">quay.io/coreos/clair</a>.</li>
<li><a href="https://github.com/genuinetools/reg">Jessfraz Docker registry web interface</a>:
   Docker registry v2 command line client and repo listing generator with
   security checks. Using
   <a href="https://hub.docker.com/r/jessfraz/reg">jessfraz/reg</a>.</li>
<li><a href="http://www.openldap.org/">OpenLDAP</a>: Using
   <a href="https://github.com/osixia/docker-openldap">osixia/openldap</a>.</li>
<li><a href="http://phpldapadmin.sourceforge.net/">phpLDAPadmin</a>:
   Using
   <a href="https://github.com/osixia/docker-phpLDAPadmin">osixia/phpldapadmin</a>.</li>
<li><a href="https://prosody.im/">Prosody IM</a>: A modern XMPP communication server. Using
  <a href="https://github.com/unclev/prosody-docker-extended">unclev/prosody-docker-extended</a>.</li>
<li><a href="https://docs.gitea.io/">Gitea</a>: Using
  <a href="https://github.com/go-gitea/gitea">gitea/gitea</a>.</li>
<li><a href="https://drone.io/">Drone</a>: Using
  <a href="https://github.com/drone/drone">drone/drone</a>. For the self hosted gitea and
  for GitHub.</li>
<li><a href="https://github.com/hackmdio/codimd">CodiMD</a>: <a href="https://hackmd.io/">HackMD</a>
  like realtime collaborative markdown notes service. Using
  <a href="https://github.com/hackmdio/docker-hackmd">docker-hackmd</a>.</li>
<li><a href="https://transmissionbt.com/">Transmission</a>: Using
  <a href="https://github.com/linuxserver/docker-transmission">linuxserver/transmission</a>
  or <a href="https://github.com/haugene/docker-transmission-openvpn">docker-transmission-openvpn</a>.</li>
<li><a href="https://wallabag.org/">Wallabag</a>: Using
  <a href="https://github.com/wallabag/docker">wallabag/wallabag</a>.</li>
<li><a href="https://syncthing.net/">Syncthing</a>: Using
  <a href="https://github.com/syncthing/syncthing">syncthing/syncthing</a>.</li>
<li><a href="https://openvpn.net/">OpenVPN</a>: Using
  <a href="https://github.com/kylemanna/docker-openvpn">kylemanna/openvpn</a>.</li>
<li><a href="https://radicale.org/">Radicale</a>: Using
  <a href="https://github.com/tomsquest/docker-radicale">tomsquest/docker-radicale</a>.</li>
<li><a href="https://taskwarrior.org/">Taskwarrior Server</a>: Using
  <a href="https://github.com/andir/docker-taskd">andir/docker-taskd</a>.</li>
<li><a href="https://nextcloud.com/">Nextcloud</a>: Using
  <a href="https://github.com/nextcloud/docker">nextcloud</a>.</li>
<li><a href="https://taiga.io/">Taiga</a>: Project management platform for agile developers
   &amp; designers and project managers. Using
  <a href="https://github.com/m0wer/docker-taiga">docker-taiga</a>.</li>
<li><a href="https://sourceforge.net/projects/nfs/">NFS Server</a>: Using
  <a href="https://github.com/ehough/docker-nfs-server">erichough/nfs-server</a>.</li>
<li><a href="https://www.isc.org/bind/">BIND9</a> Versatile, classic, complete name server
   software. Using <a href="https://github.com/sameersbn/docker-bind">sameersbn/bind</a>.</li>
<li><a href="https://wiki.mumble.info/wiki/Main_Page">Murmur</a>: Open source, low-latency,
   high quality voice chat software. Using
   <a href="https://hub.docker.com/r/m0wer/murmur">m0wer/murmur</a>.</li>
<li><a href="https://www.influxdata.com/">InfluxDB</a>: Scalable datastore for metrics,
   events, and real-time analytics. Using
   <a href="https://hub.docker.com/_/influxdb">influxdb</a>.</li>
<li><a href="https://grafana.com/">Grafana</a>: The open platform for beautiful
   analytics and monitoring. Using
   <a href="https://hub.docker.com/r/grafana/grafana">grafana/grafana</a>.</li>
<li><a href="https://www.home-assistant.io/">Home Assistant</a> Open source home automation
   that puts local control and privacy first. Using
   <a href="https://hub.docker.com/r/homeassistant/home-assistant">homeassistant/home-assistant</a></li>
<li><a href="https://www.rstudio.com/">RStudio</a> provides popular open source and
   enterprise-ready professional software for the R statistical computing
   environment. Using
   <a href="https://hub.docker.com/r/rocker/rstudio">rocker/rstudio</a>.</li>
<li><a href="https://jellyfin.media/">Jellyfin</a> The Free Software Media System. Using
  <a href="https://github.com/jellyfin/jellyfin">jellyfin/jellyfin</a>.</li>
<li><a href="https://www.portainer.io/">Portainer</a> Making Docker management easy. Using
  <a href="https://hub.docker.com/r/portainer/portainer">portainer/portainer</a>.</li>
<li><a href="https://github.com/tsudoko/anki-sync-server">Anki sync server</a> This is a
   personal Anki server, which you can sync against instead of AnkiWeb. Using
   <a href="https://hub.docker.com/r/kuklinistvan/anki-sync-server/tags">kuklinistvan/anki-sync-server</a>.</li>
<li><a href="https://moodle.org/">Moodle</a> Open-source learning plataform. Using
  <a href="https://hub.docker.com/r/moodlehq/moodle-php-apache">moodlehq/moodle-php-apache</a>.</li>
<li><a href="https://jupyter.org/hub">JupyterHub</a> A multi-user version of the notebook
   designed for companies, classrooms and research labs. Using
   <a href="https://hub.docker.com/r/m0wer/jupyterhub">m0wer/jupyterhub</a>.</li>
<li><a href="https://github.com/Jackett/Jackett">Jackett</a> API Support for your favorite
   torrent trackers. Using
   <a href="https://hub.docker.com/r/linuxserver/jackett">linuxserver/jackett</a>.</li>
<li><a href="https://github.com/Sonarr/Sonarr">Sonarr</a> API Support for your favorite
   torrent trackers. Using
   <a href="https://hub.docker.com/r/linuxserver/sonarr">linuxserver/sonarr</a>.</li>
<li><a href="https://github.com/Radarr/Radarr">Radarr</a> A fork of Sonarr to work with movies
   à la Couchpotato. Using
   <a href="https://hub.docker.com/r/linuxserver/radarr">linuxserver/radarr</a>.</li>
<li><a href="https://github.com/lidarr/Lidarr">Lidarr</a> Looks and smells like Sonarr but
   made for music. Using
   <a href="https://hub.docker.com/r/linuxserver/lidarr">linuxserver/lidarr</a>.</li>
<li><a href="https://github.com/morpheus65535/bazarr">Bazarr</a> is a companion application
   to Sonarr and Radarr. It manages and downloads subtitles based on your
   requirements. Using
   <a href="https://hub.docker.com/r/linuxserver/bazarr">linuxserver/bazarr</a>.</li>
<li><a href="https://github.com/tidusjar/Ombi">Ombi</a> Want a Movie or TV Show on Plex or
   Emby? Use Ombi! Using
   <a href="https://github.com/linuxserver/docker-ombi">linuxserver/ombi</a>.</li>
</ul>
<p>For more info about each service and how to set it up, go to
<a href="docs/services">docs/services</a>.</p>
<h2 id="setup">Setup</h2>
<ol>
<li>Install <code>sudo</code> and <code>python</code>.</li>
<li>Login as <strong>root</strong> and add your <strong>user</strong> to <em>sudoers</em> or to the <strong>sudo</strong>
   group with <code>usermod -a -G sudo [user]</code>.</li>
</ol>
<p>The idea is that you run the playbooks with the tags of the services that you
want to setup. But, there are some steps that "must" be run first, before
deploying the actual services.</p>
<p>An example approach would be:</p>
<ol>
<li>Deploy the basic stuff (dependencies, directory creation, security...):
   <code>-t init,common,sec</code></li>
<li>If everything goes well, deploy the base web server: <code>-t web</code></li>
<li>Now you are ready to deploy the desired services, for example gitea: <code>-t
   gitea</code></li>
</ol>
<h3 id="tips">Tips</h3>
<ul>
<li>You can check the available tags with:</li>
</ul>
<div class="highlight"><pre><span></span><code>ansible-playbook --list-tags full.yml
</code></pre></div>

<ul>
<li>You can create a <em>custom/</em> folder in the playbook root directory. There you
  can save your inventory files with your chosen variables for each host. This
  folder will be ignored thanks to the <em>.gitignore</em> configuration.</li>
<li>As some of the variables are passwords, you can encrypt them with
  <a href="https://docs.ansible.com/ansible/latest/user_guide/vault.html">ansible-vault</a></li>
<li>Before deploying anything, check the variables and their default values from
  <em>group_vars/all.yml</em>. Copy and change the required ones to your custom
  inventory file.</li>
<li>Deploy only a few tags with:</li>
</ul>
<p><div class="highlight"><pre><span></span><code>ansible-playbook -i custom/<span class="o">[</span>project<span class="o">]</span>/hosts.yml full.yml --extra-vars
<span class="nv">ansible_become_pass</span><span class="o">=</span><span class="s2">&quot;[sudo_password]&quot;</span> --ask-vault-pass -t gitea
</code></pre></div>
* By default, the configuration files of the services won't be overridden in
  most cases, meaning that if they already existed they won't be modified, to
  preserve their possible manual modifications. To avoid this behaviour and
  overwrite them, pass the <code>override=True</code> extra var.</p>
<h3 id="firewall">Firewall</h3>
<p>If you are behind some kind of firewall or you need to setup NAT, you should
add the following ports:</p>
<ul>
<li><strong>80</strong> for HTTP connections, used for the <code>letsencrypt</code> verification</li>
<li><strong>443</strong> for HTTPs connections, used by the reverse proxy to serve access to
  the web services.</li>
<li>The SSH port you choose, or <strong>2222</strong> by default.</li>
<li>All the desired ports that some services have.</li>
</ul>
<h3 id="letsencrypt">Letsencrypt</h3>
<p>The main domain cert needs to be obtained using the <strong>standalone</strong> method since
we don't have a working webserver by this point (the server needs the cert). So
the webroot path will be empty in <em>/etc/letsencrypt/renewal/{{ base_domain
}}.conf</em>. You should manually specify it adding:</p>
<div class="highlight"><pre><span></span><code>authenticator = webroot
webroot_path = /var/www/letsencrypt,
</code></pre></div>

<h3 id="nvidia-runtime-support">Nvidia runtime support</h3>
<p>Some services (such as jellyfin and jupyter) can benefit from GPU acceleration.
In order to generally enable nvdia runtime support for the services set the
variable <code>nvidia_runtime</code> to <code>true</code>. Note that the nvidia-container-toolkit
must be installed manually, check
<a href="https://github.com/NVIDIA/nvidia-docker">nvidia-docker</a>.</p>
<h2 id="backup">Backup</h2>
<p>Make sure to backup your <code>data_path</code> (by default <em>/data</em>) and the docker
volumes (used by the databases) from <em>/var/lib/docker/volumes</em> if used.</p>
<h2 id="license">License</h2>
<p>GPLv3</p>
<h2 id="author-information">Author Information</h2>
<p>m0wer: m0wer (at) autistici.org</p>
                
                  
                    

<hr>
<div class="md-source-date">
  <small>
    
      Last update: <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-timeago"><span class="timeago" datetime="2020-08-19T17:27:49+00:00" locale="en"></span></span><span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-iso_date">2020-08-19</span>
    
  </small>
</div>
                  
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid" aria-label="Footer">
        
        
          <a href="ldap/" title="LDAP configuration" class="md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-footer-nav__title">
              <div class="md-ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                LDAP configuration
              </div>
            </div>
            <div class="md-footer-nav__button md-icon">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        Made with
        <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
          Material for MkDocs
        </a>
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="assets/javascripts/vendor.d1f5a259.min.js"></script>
      <script src="assets/javascripts/bundle.d5fec882.min.js"></script><script id="__lang" type="application/json">{"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents"}</script>
      
      <script>
        app = initialize({
          base: ".",
          features: [],
          search: Object.assign({
            worker: "assets/javascripts/worker/search.fae956e7.min.js"
          }, typeof search !== "undefined" && search)
        })
      </script>
      
    
  
          <script src="https://cdnjs.cloudflare.com/ajax/libs/timeago.js/4.0.0-beta.2/timeago.min.js"></script>
          <script src="https://cdnjs.cloudflare.com/ajax/libs/timeago.js/4.0.0-beta.2/timeago.locales.min.js"></script>
          <script>
            var nodes = document.querySelectorAll('.timeago');
            var locale = nodes[0].getAttribute('locale');
            timeago.render(nodes, locale);
          </script>
        </body>
</html>